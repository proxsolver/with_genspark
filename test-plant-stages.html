<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹ë¬¼ ì„±ì¥ ë‹¨ê³„ í…ŒìŠ¤íŠ¸</title>
    <script src="plant-system.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-result {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .plant-display {
            font-size: 48px;
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸŒ± ì‹ë¬¼ ì„±ì¥ ë‹¨ê³„ í…ŒìŠ¤íŠ¸</h1>
    <button onclick="runTest()">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
    <button onclick="clearData()">ë°ì´í„° ì´ˆê¸°í™”</button>
    <div id="results"></div>

    <script>
        function log(message, isSuccess = true) {
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
        }

        function displayPlant(emoji, stage, water) {
            const div = document.createElement('div');
            div.className = 'plant-display';
            div.innerHTML = `
                <div>${emoji}</div>
                <div style="font-size: 16px;">Stage ${stage} | Water: ${water}</div>
            `;
            document.getElementById('results').appendChild(div);
        }

        function clearData() {
            localStorage.removeItem('plantSystemUser');
            localStorage.removeItem('plantSystemPlants');
            document.getElementById('results').innerHTML = '';
            log('âœ… ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ');
        }

        function runTest() {
            document.getElementById('results').innerHTML = '';
            log('ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œì‘...');

            try {
                // 1. ì‚¬ìš©ì ìƒì„±
                const user = plantSystem.getUserData();
                log(`âœ… ì‚¬ìš©ì ìƒì„±: ${user.userId}`);

                // 2. ì”¨ì•— ì‹¬ê¸°
                const plant = plantSystem.plantSeed(user.userId);
                log(`âœ… ì”¨ì•— ì‹¬ê¸° ì™„ë£Œ: ${plant.plantType} (Stage ${plant.stage})`);
                displayPlant(plant.plantType, plant.stage, plant.waterCount);

                // 3. Stage 0 â†’ 1 (5íšŒ ë¬¼ì£¼ê¸°)
                log('ğŸ’§ Stage 0 â†’ 1: 5íšŒ ë¬¼ì£¼ê¸° ì‹œì‘...');
                for (let i = 1; i <= 5; i++) {
                    const result = plantSystem.waterPlant(plant.plantId);
                    if (!result.success) {
                        log(`âŒ ë¬¼ì£¼ê¸° ${i}íšŒ ì‹¤íŒ¨: ${result.message}`, false);
                        return;
                    }
                    log(`  ${i}íšŒ: ë¬¼ ${result.waterCount}, Stage ${result.stage}`);
                }

                let updatedPlant = plantSystem.getPlant(plant.plantId);
                log(`âœ… Stage 1 ë„ë‹¬: ${updatedPlant.plantType}`);
                displayPlant(updatedPlant.plantType, updatedPlant.stage, updatedPlant.waterCount);

                // 4. Stage 1 â†’ 2 (10íšŒ ë¬¼ì£¼ê¸°)
                log('ğŸ’§ Stage 1 â†’ 2: 10íšŒ ë¬¼ì£¼ê¸° ì‹œì‘...');
                for (let i = 1; i <= 10; i++) {
                    const result = plantSystem.waterPlant(plant.plantId);
                    if (!result.success) {
                        log(`âŒ ë¬¼ì£¼ê¸° ${i}íšŒ ì‹¤íŒ¨: ${result.message}`, false);
                        return;
                    }
                    log(`  ${i}íšŒ: ë¬¼ ${result.waterCount}, Stage ${result.stage}`);
                }

                updatedPlant = plantSystem.getPlant(plant.plantId);
                log(`âœ… Stage 2 ë„ë‹¬: ${updatedPlant.plantType}`);
                displayPlant(updatedPlant.plantType, updatedPlant.stage, updatedPlant.waterCount);

                // 5. Stage 2 â†’ 3 (15íšŒ ë¬¼ì£¼ê¸°)
                log('ğŸ’§ Stage 2 â†’ 3: 15íšŒ ë¬¼ì£¼ê¸° ì‹œì‘...');
                for (let i = 1; i <= 15; i++) {
                    const result = plantSystem.waterPlant(plant.plantId);
                    if (!result.success) {
                        log(`âŒ ë¬¼ì£¼ê¸° ${i}íšŒ ì‹¤íŒ¨: ${result.message}`, false);
                        return;
                    }
                    log(`  ${i}íšŒ: ë¬¼ ${result.waterCount}, Stage ${result.stage}, Status: ${result.status}`);
                }

                updatedPlant = plantSystem.getPlant(plant.plantId);
                log(`âœ… Stage 3 ë„ë‹¬ (ì™„ì„±): ${updatedPlant.plantType}, Status: ${updatedPlant.status}`);
                displayPlant(updatedPlant.plantType, updatedPlant.stage, updatedPlant.waterCount);

                // 6. ì¶”ê°€ ë¬¼ì£¼ê¸° ì‹œë„ (ì‹¤íŒ¨í•´ì•¼ í•¨)
                log('ğŸ’§ ì™„ì„±ëœ ì‹ë¬¼ì— ë¬¼ì£¼ê¸° ì‹œë„...');
                const finalResult = plantSystem.waterPlant(plant.plantId);
                if (!finalResult.success) {
                    log(`âœ… ì˜ˆìƒëŒ€ë¡œ ì‹¤íŒ¨: ${finalResult.message}`);
                } else {
                    log('âŒ ì™„ì„±ëœ ì‹ë¬¼ì— ë¬¼ì„ ì¤„ ìˆ˜ ìˆìœ¼ë©´ ì•ˆë¨!', false);
                }

                log('ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!');

            } catch (error) {
                log(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, false);
                console.error(error);
            }
        }
    </script>
</body>
</html>
