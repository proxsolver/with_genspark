<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í€´ì¦ˆ ìƒì„±ê¸°</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 2rem auto; padding: 1rem; background-color: #f8f9fa; }
        h1 { text-align: center; }
        .form-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        select, button { width: 100%; padding: 0.75rem; font-size: 1rem; border-radius: 0.25rem; border: 1px solid #ccc; }
        button { background-color: #007bff; color: white; cursor: pointer; border: none; }
        button:disabled { background-color: #aaa; }
        #result { margin-top: 1.5rem; padding: 1rem; background-color: #e9ecef; border-radius: 0.25rem; text-align: center; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>ğŸ“ ì œë¯¸ë‚˜ì´ í€´ì¦ˆ ìƒì„±ê¸°</h1>
    <form id="quiz-generator-form">
        <div class="form-group">
            <label for="grade">í•™ë…„</label>
            <select id="grade" name="grade" required>
                <option value="1">1í•™ë…„</option>
                <option value="2">2í•™ë…„</option>
                <option value="3">3í•™ë…„</option>
                <option value="4">4í•™ë…„</option>
                <option value="5">5í•™ë…„</option>
                <option value="6">6í•™ë…„</option>
            </select>
        </div>
        <div class="form-group">
            <label for="subject">ê³¼ëª©</label>
            <select id="subject" name="subject" required>
                <!-- ê³¼ëª©ì€ /src/data/questions/grade1/ í´ë” ê¸°ì¤€ìœ¼ë¡œ ë™ì  ìƒì„± -->
            </select>
        </div>
        <div class="form-group">
            <label for="difficulty">ë‚œì´ë„</label>
            <select id="difficulty" name="difficulty" required>
                <option value="1">1 (ì‰¬ì›€)</option>
                <option value="2">2 (ë³´í†µ)</option>
                <option value="3">3 (ì–´ë ¤ì›€)</option>
            </select>
        </div>
        <button type="submit" id="generate-btn">í€´ì¦ˆ ìƒì„±</button>
    </form>
    <div id="result" class="hidden"></div>

    <script>
        const gradeSelect = document.getElementById('grade');
        const subjectSelect = document.getElementById('subject');
        const form = document.getElementById('quiz-generator-form');
        const generateBtn = document.getElementById('generate-btn');
        const resultDiv = document.getElementById('result');

        // ì„ì‹œ ê³¼ëª© ëª©ë¡ - ì‹¤ì œë¡œëŠ” APIë¥¼ í†µí•´ ë°›ì•„ì™€ì•¼ í•©ë‹ˆë‹¤.
        const subjectsByGrade = {
            1: ['korean', 'math', 'common', 'science'],
            // í•™ë…„ë³„ë¡œ ë‹¤ë¥¸ ê³¼ëª©ì´ ìˆë‹¤ë©´ ì¶”ê°€
        };

        function populateSubjects(grade) {
            const subjects = subjectsByGrade[grade] || subjectsByGrade[1]; // ê¸°ë³¸ê°’
            subjectSelect.innerHTML = '';
            subjects.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject;
                option.textContent = subject.charAt(0).toUpperCase() + subject.slice(1);
                subjectSelect.appendChild(option);
            });
        }
        
        // ì´ˆê¸° ê³¼ëª© ëª©ë¡ ì±„ìš°ê¸°
        populateSubjects(gradeSelect.value);

        // í•™ë…„ ë³€ê²½ ì‹œ ê³¼ëª© ëª©ë¡ ì—…ë°ì´íŠ¸
        gradeSelect.addEventListener('change', (e) => {
            // ì§€ê¸ˆì€ ëª¨ë“  í•™ë…„ì˜ ê³¼ëª©ì´ ë™ì¼í•˜ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
            // í•„ìš” ì‹œ populateSubjects(e.target.value) í˜¸ì¶œ
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const grade = gradeSelect.value;
            const subject = subjectSelect.value;
            const difficulty = document.getElementById('difficulty').value;

            generateBtn.disabled = true;
            generateBtn.textContent = 'ìƒì„± ì¤‘...';
            resultDiv.classList.remove('hidden');
            resultDiv.textContent = 'ì œë¯¸ë‚˜ì´ API í˜¸ì¶œ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.';

            try {
                const response = await fetch('/api/generate-quiz', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ grade, subject, difficulty }),
                });

                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }

                resultDiv.style.backgroundColor = '#d4edda';
                resultDiv.textContent = `âœ… ìƒì„± ì™„ë£Œ! íŒŒì¼ ìœ„ì¹˜: ${result.filePath}`;

            } catch (error) {
                resultDiv.style.backgroundColor = '#f8d7da';
                resultDiv.textContent = `âŒ ìƒì„± ì‹¤íŒ¨: ${error.message}`;
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'í€´ì¦ˆ ìƒì„±';
            }
        });
    </script>
</body>
</html>
