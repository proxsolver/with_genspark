# 제미나이 API 기반 퀴즈 생성 앱 개발 계획

## 1. 목표
`GEN_QUIZ.MD`의 요구사항에 따라, 관리자가 웹 페이지에서 학년, 과목, 난이도를 선택하면 제미나이 API를 통해 고품질의 퀴즈를 자동으로 생성하고, 기존 프로젝트의 JSON 파일 구조에 맞춰 저장하는 애플리케이션을 개발한다.

## 2. 기술 스택
- **프론트엔드:** HTML, JavaScript (기존 `admin.html` 또는 신규 페이지)
- **백엔드:** Next.js API Route (서버리스 함수)
- **API:** Google Gemini API

## 3. 개발 절차

### 1단계: 프론트엔드 UI 개발
- **파일 위치**: `/admin/quiz-generator.html` (신규 생성)
- **기능**:
    - **학년 선택**: 1학년부터 6학년까지 선택할 수 있는 드롭다운 메뉴.
    - **과목 선택**: `src/data/questions/` 하위 폴더 구조를 기반으로 동적으로 과목 목록을 생성하거나, 주요 과목(국어, 영어, 수학, 사회, 과학 등)을 하드코딩한 드롭다운 메뉴.
    - **난이도 선택**: 1(쉬움), 2(보통), 3(어려움)을 선택할 수 있는 드롭다운 메뉴.
    - **생성 요청 버튼**: 클릭 시 백엔드 API에 요청을 보내는 버튼.
    - **상태 표시 영역**: "생성 중...", "✅ `경로/파일명.json` 생성 완료!", "❌ 생성 실패: 오류 메시지" 와 같은 결과를 표시하는 영역.

### 2단계: 백엔드 API 라우트 생성
- **파일 위치**: `src/app/api/generate-quiz/route.ts` (신규 생성)
- **주요 로직**:
    1.  **요청 수신**: 프론트엔드로부터 `grade`, `subject`, `difficulty` 파라미터를 POST 방식으로 수신한다.
    2.  **프롬프트 생성**:
        - `GEN_QUIZ/GEN_QUIZ.MD` 파일을 읽어 프롬프트 템플릿을 가져온다.
        - 템플릿의 `{{학년}}`, `{{과목}}`, `{{난이도}}` 플레이스홀더를 수신한 파라미터 값으로 교체하여 최종 프롬프트를 완성한다.
    3.  **제미나이 API 호출**:
        - `process.env.GEMINI_API_KEY` 환경 변수를 사용하여 API 키를 안전하게 로드한다.
        - 완성된 프롬프트를 제미나이 API에 전송하고, 생성된 퀴즈 데이터(JSON 형식의 텍스트)를 응답으로 받는다.
    4.  **데이터 검증 및 저장**:
        - 제미나이 API의 응답이 유효한 JSON 형식인지 파싱하여 확인한다.
        - **파일 경로 결정**: `src/data/questions/grade{grade}/{subject}/` 디렉토리로 경로를 설정한다.
        - **파일 이름 결정**: 해당 디렉토리 내 `level{difficulty}-*.json` 패턴의 파일들을 읽어 가장 큰 파일 번호를 찾은 후, 1을 더하여 새 파일 이름을 결정한다. (예: `level2-3.json`이 마지막이면 `level2-4.json`으로 생성)
        - 파싱된 JSON 데이터를 `fs.writeFileSync`를 사용해 예쁘게 포맷팅하여 새 파일에 저장한다.
    5.  **성공/실패 응답**:
        - **성공 시**: `201` 상태 코드와 함께 생성된 파일의 경로를 JSON 형식으로 응답한다. (`{ "message": "퀴즈 생성 성공!", "filePath": "..." }`)
        - **실패 시**: 오류 유형에 따라 적절한 상태 코드(예: 400, 500)와 오류 메시지를 응답한다.

### 4단계: 환경 설정
- `.env.local` 파일에 `GEMINI_API_KEY='YOUR_API_KEY'`를 추가하여 API 키를 관리한다.
- `.gitignore`에 `.env.local`이 포함되어 있는지 확인하여 키가 외부에 노출되지 않도록 한다.

## 4. 예상 파일 구조 (변경/추가)

```
/
├── admin/
│   └── quiz-generator.html  (신규)
├── src/
│   └── app/
│       └── api/
│           └── generate-quiz/
│               └── route.ts   (신규)
├── GEN_QUIZ/
│   └── GEMINI_QUIZ_GENERATION_PLAN.md (본 파일)
└── .env.local (신규, API 키 저장)
```

## 5. 기대 효과
- 수동으로 퀴즈를 제작하던 과정을 자동화하여 콘텐츠 제작 시간을 획기적으로 단축.
- `GEN_QUIZ.MD`의 규칙에 따라 일관성 있고 품질 높은 퀴즈 데이터를 안정적으로 확보.
- 기존 프로젝트 구조와 완벽하게 통합되어 확장 및 유지보수가 용이.
