<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduPet Collection - í•™ìŠµìœ¼ë¡œ í‚¤ìš°ëŠ” ê²½ì œ ìƒíƒœê³„</title>
    <meta name="description" content="ì´ˆë“±í•™ìƒì„ ìœ„í•œ í†µí•© í•™ìŠµ ê²Œì„ ì•±. í•™ìŠµ, ë†ì¥ ê²½ì˜, ë™ë¬¼ ìˆ˜ì§‘ì´ í•˜ë‚˜ë¡œ!">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- í•œê¸€ í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- PWA ê´€ë ¨ ë©”íƒ€íƒœê·¸ -->
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="EduPet Collection">

    <!-- ë¡œê±° ì‹œìŠ¤í…œ (ê°€ì¥ ë¨¼ì € ë¡œë“œ) -->
    <script src="logger.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .font-game {
            font-family: 'Noto Sans KR', 'Comic Sans MS', cursive;
            font-weight: 600;
        }

        .gradient-bg {
            background: linear-gradient(135deg,
                rgba(76, 175, 80, 0.1) 0%,
                rgba(255, 152, 0, 0.1) 50%,
                rgba(33, 150, 243, 0.1) 100%
            );
        }

        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .progress-bar {
            transition: width 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes coinBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .animate-fade-in {
            animation: fadeIn 1s ease-out forwards;
        }

        .animate-slide-up {
            animation: slideUp 1s ease-out forwards;
        }

        .harvest-modal-show {
            animation: scaleIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .coin-bounce {
            animation: coinBounce 0.6s ease-in-out infinite;
        }

        /* ì¶•í•˜ ëª¨ë‹¬ ì• ë‹ˆë©”ì´ì…˜ */
        .celebration-modal {
            animation: modalZoomIn 0.5s ease-out;
        }

        @keyframes modalZoomIn {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .glow-pulse {
            animation: glowPulse 2s ease-in-out infinite;
        }

        @keyframes glowPulse {
            0%, 100% {
                filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
                transform: scale(1);
            }
            50% {
                filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.8));
                transform: scale(1.05);
            }
        }

        /* ì»¨í˜í‹° ì• ë‹ˆë©”ì´ì…˜ */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
        }
    </style>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0fdf4',
                            500: '#4CAF50',
                            600: '#16a34a',
                        },
                        secondary: {
                            50: '#fff7ed',
                            500: '#FF9800',
                            600: '#ea580c',
                        },
                        accent: {
                            50: '#eff6ff',
                            500: '#2196F3',
                            600: '#2563eb',
                        },
                        danger: {
                            50: '#fef2f2',
                            500: '#F44336',
                            600: '#dc2626',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="gradient-bg min-h-screen">
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <!-- íƒ€ì´í‹€ ì„¹ì…˜ -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6 opacity-0 animate-fade-in">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 font-game mb-2">
                        ğŸŒ± EduPet Collection
                    </h1>
                    <p class="text-sm text-gray-600 flex items-center flex-wrap gap-2">
                        <span>
                            <span id="userAvatarDisplay" style="font-size: 1.2rem;">ğŸ°</span>
                            <span id="userNameDisplay">í•™ìŠµì</span>ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!
                        </span>
                        <button onclick="changeGrade()" id="gradeDisplay" class="px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs rounded-full font-semibold transition-colors cursor-pointer" title="í´ë¦­í•˜ì—¬ í•™ë…„ ë³€ê²½">
                            ğŸ“ 4í•™ë…„
                        </button>
                        <span id="offlineModeIndicator" class="hidden px-2 py-0.5 bg-gray-200 text-gray-600 text-xs rounded-full">ğŸ“´ ì˜¤í”„ë¼ì¸</span>
                        <a href="login.html" id="loginButton" class="hidden px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-xs rounded-full transition-colors" onclick="return handleLoginClick()">ğŸ” ë¡œê·¸ì¸í•˜ê³  ë™ê¸°í™”</a>
                    </p>
                </div>

                <div class="text-right">
                    <div class="flex items-center justify-end space-x-2 mb-2">
                        <span class="text-2xl">ğŸ’°</span>
                        <span id="moneyDisplay" class="text-2xl font-bold text-primary-600">0 ì½”ì¸</span>
                    </div>
                    <div class="text-sm text-gray-600 mb-1">
                        ğŸ”¥ <span id="streakDisplay">0ì¼ì§¸</span> í”Œë ˆì´ ì¤‘
                    </div>
                    <div class="text-sm text-gray-600">
                        ğŸ¾ <span id="animalCountDisplay">0ë§ˆë¦¬</span>ì˜ íŒ» ë³´ìœ 
                    </div>
                </div>
            </div>
        </div>

        <!-- ì˜¤ëŠ˜ì˜ í•™ìŠµ (ì•½ì  ë³´ì™„) -->
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 0.2s forwards;">
            <div class="flex items-start space-x-4">
                <div class="text-6xl" id="highestAnimalDisplay">ğŸ°</div>
                <div class="flex-1">
                    <div class="flex items-center space-x-2 mb-3">
                        <span class="text-xl">ğŸ’¡</span>
                        <h2 class="text-xl font-bold font-game">ì˜¤ëŠ˜ì˜ í•™ìŠµ</h2>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-semibold">ì•½ì  ë³´ì™„</span>
                    </div>

                    <!-- ë§í’ì„  ìŠ¤íƒ€ì¼ì˜ ë¬¸ì œ í‘œì‹œ -->
                    <div class="bg-white rounded-xl p-4 mb-3 shadow-md relative">
                        <div class="absolute -left-3 top-4">
                            <div class="w-0 h-0 border-t-8 border-b-8 border-r-8 border-transparent border-r-white"></div>
                        </div>

                        <div class="mb-3">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="text-lg" id="weaknessSubjectIcon">ğŸ“š</span>
                                <span class="font-bold text-gray-800" id="weaknessSubjectName">ì•½ì  ê³¼ëª©</span>
                                <span class="px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs">ë³´í†µ</span>
                            </div>
                            <p class="text-gray-700 mb-3" id="weaknessQuestion">
                                ì˜¤ëŠ˜ì˜ ë¬¸ì œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                            </p>
                        </div>

                        <!-- ì •ë‹µ í‘œì‹œ -->
                        <div class="bg-green-50 border-2 border-green-200 rounded-lg p-3 mb-2">
                            <div class="flex items-center space-x-2 mb-1">
                                <span class="text-lg">âœ…</span>
                                <span class="font-bold text-green-900">ì •ë‹µ</span>
                            </div>
                            <p class="text-sm text-green-800" id="weaknessAnswer">ì •ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
                        </div>

                        <!-- í•´ì„¤ í‘œì‹œ -->
                        <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-3">
                            <div class="flex items-center space-x-2 mb-1">
                                <span class="text-lg">ğŸ’¡</span>
                                <span class="font-bold text-blue-900">í•´ì„¤</span>
                            </div>
                            <p class="text-sm text-gray-700" id="weaknessExplanation">í•´ì„¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</p>
                        </div>
                    </div>

                    <button onclick="loadNewWeaknessQuestion()" class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600 transition-colors">
                        ë‹¤ìŒ ë¬¸ì œ ë³´ê¸°
                    </button>
                </div>
            </div>
        </div>

        <!-- ì¼ì¼ ë¯¸ì…˜ ì§„í–‰ ìƒí™© -->
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl shadow-lg p-5 mb-6 text-gray-800 opacity-0" style="animation: slideUp 1s ease-out 0.3s forwards;">
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">ğŸ¯</span>
                    <h2 class="text-lg font-bold">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</h2>
                </div>
                <button onclick="window.location.href='daily-missions.html'" class="px-3 py-1 bg-blue-100 hover:bg-blue-200 rounded-lg text-sm font-semibold transition-all">
                    ì „ì²´ë³´ê¸° â†’
                </button>
            </div>
            <div id="mission-widget" class="space-y-2">
                <!-- ë¯¸ì…˜ ìœ„ì ¯ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ì˜¤ëŠ˜ í•™ìŠµ ë¯¸ì…˜ -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 0.4s forwards;">
            <div class="flex items-center space-x-2 mb-4">
                <span class="text-xl">ğŸ“š</span>
                <h2 class="text-xl font-bold font-game">ê³¼ëª© ì„ íƒ</h2>
                <span id="dailyProgressDisplay" class="px-3 py-1 bg-secondary-100 text-secondary-800 rounded-full text-sm font-semibold">0/9 ê³¼ëª©</span>
            </div>

            <!-- ì§„í–‰ë¥  ë°” -->
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-600">í•™ìŠµ ì§„í–‰ë¥ </span>
                    <span id="progressPercentDisplay" class="text-sm font-medium">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="progressBarDisplay" class="bg-primary-500 h-3 rounded-full progress-bar" style="width: 0%;"></div>
                </div>
            </div>

            <!-- í•„ìˆ˜ ê³¼ëª© -->
            <div class="mb-4">
                <h4 class="text-sm font-semibold text-gray-700 mb-3">í•„ìˆ˜ ê³¼ëª©</h4>
                <div class="grid grid-cols-3 gap-3">
                    <button id="english-btn" onclick="startQuickQuiz('english')" class="border-2 border-gray-300 text-gray-700 p-4 rounded-xl h-20 flex flex-col items-center justify-center card-hover hover:border-primary-500 hover:bg-primary-50">
                        <div class="flex items-center space-x-1 mb-1">
                            <span>ğŸ‡ºğŸ‡¸</span>
                            <span class="font-medium">ì˜ì–´</span>
                        </div>
                        <div id="english-status" class="text-xs opacity-80">í•„ìˆ˜</div>
                    </button>

                    <button id="weakness-btn" onclick="startWeaknessQuiz()" class="border-2 border-orange-300 text-gray-700 p-4 rounded-xl h-20 flex flex-col items-center justify-center card-hover hover:border-orange-500 hover:bg-orange-50">
                        <div class="flex items-center space-x-1 mb-1">
                            <span id="weaknessIcon">ğŸ“Š</span>
                            <span class="font-medium" id="weaknessLabel">ì•½í•œê³¼ëª©</span>
                        </div>
                        <div id="weakness-status" class="text-xs opacity-80">í•„ìˆ˜</div>
                    </button>

                    <button id="all-subjects-btn" onclick="window.location.href='subject-select.html'" class="border-2 border-gray-300 text-gray-500 p-4 rounded-xl h-20 flex flex-col items-center justify-center card-hover hover:border-primary-500 hover:bg-primary-50">
                        <div class="flex items-center space-x-1 mb-1">
                            <span>ğŸ“š</span>
                            <span class="font-medium">ê³¼ëª©ì„ íƒ</span>
                        </div>
                        <div id="all-subjects-status" class="text-xs opacity-80">ì„ íƒí•˜ê¸°</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- ë‚˜ì˜ ë†ì¥ -->
        <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 0.6s forwards;">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-2">
                    <span class="text-xl">ğŸŒ±</span>
                    <h2 class="text-xl font-bold font-game">ë‚˜ì˜ ë†ì¥</h2>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="text-right">
                        <div class="text-sm text-gray-600">ğŸ« ì„±ì¥ê¶Œ</div>
                        <div class="font-bold text-green-600" id="farm-growth-tickets">0ê°œ</div>
                    </div>
                    <a href="admin.html" class="px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg text-sm border border-red-200">
                        âš™ï¸
                    </a>
                </div>
            </div>

            <!-- ë‹¤ìŒ ë³´ìƒ ì•ˆë‚´ -->
            <div class="bg-blue-50 rounded-lg p-3 mb-4 border border-blue-200">
                <div class="flex items-center space-x-2">
                    <span class="text-lg">ğŸ¯</span>
                    <div class="flex-1">
                        <p class="text-xs text-blue-700" id="farm-next-reward">3ê³¼ëª© ë‹¬ì„± ì‹œ: ì„±ì¥ê¶Œ 1ê°œ</p>
                    </div>
                </div>
            </div>

            <!-- í™”ë¶„ ì˜ì—­ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <!-- í™”ë¶„ 1 -->
                <div class="bg-white rounded-lg p-4 shadow-md border-2 border-green-200">
                    <div class="text-center mb-2">
                        <h3 class="text-sm font-bold text-gray-800">ğŸª´ í™”ë¶„ #1</h3>
                    </div>

                    <div class="relative" id="home-pot1-container">
                        <div class="bg-amber-100 rounded-lg border-4 border-amber-300 h-32 flex flex-col items-center justify-end p-3 relative overflow-hidden"
                             id="home-pot1" style="cursor: pointer;">
                            <div id="home-plant1-display" class="absolute bottom-3 left-1/2 transform -translate-x-1/2"></div>
                            <div id="home-empty-pot1" class="text-center">
                                <div class="text-3xl mb-1">ğŸ•³ï¸</div>
                                <div class="text-xs text-gray-500">ì”¨ì•— ì‹¬ê¸°</div>
                            </div>
                        </div>

                        <div id="home-plant1-info" class="mt-2 text-center hidden">
                            <div class="text-xs text-gray-600 mb-1" id="home-plant1-status">ì„±ì¥ ì¤‘</div>
                            <div class="mb-2">
                                <div class="flex justify-between text-xs text-gray-600 mb-1">
                                    <span>ğŸ’§ ë¬¼</span>
                                    <span id="home-plant1-water">0/20</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-1.5">
                                    <div class="bg-blue-500 h-1.5 rounded-full transition-all" id="home-plant1-water-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="text-xs text-gray-600" id="home-plant1-time">â° 24ì‹œê°„</div>
                        </div>

                        <div class="mt-2" id="home-pot1-actions">
                            <button onclick="homePlantSeed(1)" class="w-full px-3 py-2 bg-green-500 text-white rounded-lg text-xs hover:bg-green-600 transition-all">
                                ğŸŒ° ì”¨ì•— ì‹¬ê¸°
                            </button>
                        </div>
                    </div>
                </div>

                <!-- í™”ë¶„ 2 -->
                <div class="bg-white rounded-lg p-4 shadow-md border-2 border-green-200">
                    <div class="text-center mb-2">
                        <h3 class="text-sm font-bold text-gray-800">ğŸª´ í™”ë¶„ #2</h3>
                    </div>

                    <div class="relative" id="home-pot2-container">
                        <div class="bg-amber-100 rounded-lg border-4 border-amber-300 h-32 flex flex-col items-center justify-end p-3 relative overflow-hidden"
                             id="home-pot2" style="cursor: pointer;">
                            <div id="home-plant2-display" class="absolute bottom-3 left-1/2 transform -translate-x-1/2"></div>
                            <div id="home-empty-pot2" class="text-center">
                                <div class="text-3xl mb-1">ğŸ•³ï¸</div>
                                <div class="text-xs text-gray-500">ì”¨ì•— ì‹¬ê¸°</div>
                            </div>
                        </div>

                        <div id="home-plant2-info" class="mt-2 text-center hidden">
                            <div class="text-xs text-gray-600 mb-1" id="home-plant2-status">ì„±ì¥ ì¤‘</div>
                            <div class="mb-2">
                                <div class="flex justify-between text-xs text-gray-600 mb-1">
                                    <span>ğŸ’§ ë¬¼</span>
                                    <span id="home-plant2-water">0/20</span>
                                </div>
                                <div class="bg-gray-200 rounded-full h-1.5">
                                    <div class="bg-blue-500 h-1.5 rounded-full transition-all" id="home-plant2-water-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="text-xs text-gray-600" id="home-plant2-time">â° 24ì‹œê°„</div>
                        </div>

                        <div class="mt-2" id="home-pot2-actions">
                            <button onclick="homePlantSeed(2)" class="w-full px-3 py-2 bg-green-500 text-white rounded-lg text-xs hover:bg-green-600 transition-all">
                                ğŸŒ° ì”¨ì•— ì‹¬ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë¬¼ì£¼ê¸° ì•ˆë‚´ -->
            <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                <div class="text-center">
                    <p class="text-xs text-blue-700 mb-1">
                        ğŸ’§ ì‹ë¬¼ì„ í´ë¦­í•˜ë©´ ì•½ì  ê³¼ëª© ë¬¸ì œë¡œ ë¬¼ì„ ì¤„ ìˆ˜ ìˆì–´ìš”!
                    </p>
                    <div class="text-xs text-blue-600">
                        ğŸ’¡ ë¬¼ 20ê°œ + 24ì‹œê°„ + ì„±ì¥ê¶Œ 1ê°œ = ì„±ì¥!
                    </div>
                </div>
            </div>
        </div>


        <!-- ìµœê·¼ í•™ìŠµ í™œë™ -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 0.9s forwards;">
            <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                <span class="mr-2">ğŸ“…</span>
                ìµœê·¼ í•™ìŠµ í™œë™
            </h2>

            <!-- ì˜¤ëŠ˜ì˜ í•™ìŠµ í˜„í™© -->
            <div class="grid grid-cols-3 gap-3 mb-6">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-3 text-center">
                    <div class="text-xs text-gray-600 mb-1">ì˜¤ëŠ˜ í‘¼ ë¬¸ì œ</div>
                    <div class="text-2xl font-bold text-blue-600" id="todayQuestions">0</div>
                    <div class="text-xs text-gray-500">ë¬¸ì œ</div>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-3 text-center">
                    <div class="text-xs text-gray-600 mb-1">ì •ë‹µë¥ </div>
                    <div class="text-2xl font-bold text-purple-600" id="todayAccuracy">0</div>
                    <div class="text-xs text-gray-500">%</div>
                </div>
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-3 text-center">
                    <div class="text-xs text-gray-600 mb-1">í•™ìŠµ ì‹œê°„</div>
                    <div class="text-2xl font-bold text-green-600" id="todayMinutes">0</div>
                    <div class="text-xs text-gray-500">ë¶„</div>
                </div>
            </div>

            <!-- ì£¼ê°„ í™œë™ ê·¸ë˜í”„ -->
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-bold text-gray-700">ìµœê·¼ 7ì¼ í™œë™</h3>
                <div class="text-sm">
                    <span class="text-orange-600 font-bold" id="streakDays">0</span>
                    <span class="text-gray-600">ì¼ ì—°ì† ğŸ”¥</span>
                </div>
            </div>
            <div class="grid grid-cols-7 gap-2 text-center">
                <div id="weeklyLabels" class="contents">
                    <!-- Day labels will be inserted here -->
                </div>

                <div id="weeklyActivity" class="contents">
                    <!-- Weekly activity cells will be inserted here -->
                </div>
            </div>
        </div>

        <!-- ë™ë¬¼ ìˆ˜ì§‘ -->
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 1s forwards;">
            <div class="flex items-start space-x-4">
                <div class="text-6xl" id="topAnimalDisplay">ğŸ¦</div>
                <div class="flex-1">
                    <div class="flex items-center space-x-2 mb-3">
                        <span class="text-xl">âœ¨</span>
                        <h2 class="text-xl font-bold font-game">ë™ë¬¼ ìˆ˜ì§‘</h2>
                    </div>

                    <div class="bg-white rounded-xl p-4 mb-3 shadow-md">
                        <p class="text-sm text-gray-700 mb-3" id="animalMessage">
                            "ì•ˆë…•! ë‚˜ëŠ” <span id="topAnimalName">ë„ë§ˆë±€</span>ì´ì•¼! í˜„ì¬ ë½‘ê¸°ê¶Œì´ <span id="ticketCount" class="font-bold text-purple-600">0ì¥</span> ìˆì–´. 25ë¬¸ì œë¥¼ í’€ë©´ ìƒˆë¡œìš´ ì¹œêµ¬ë¥¼ ë§Œë‚  ìˆ˜ ìˆì–´!"
                        </p>

                        <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                            <div class="bg-gray-50 rounded p-2">
                                <div class="text-gray-600">ì¼ë°˜ ë½‘ê¸°ê¶Œ</div>
                                <div class="font-bold" id="normalTickets">0ì¥</div>
                            </div>
                            <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded p-2">
                                <div class="text-gray-600">í”„ë¦¬ë¯¸ì—„ ë½‘ê¸°ê¶Œ</div>
                                <div class="font-bold text-yellow-700" id="premiumTickets">0ì¥</div>
                            </div>
                        </div>

                        <button onclick="window.location.href='animal-collection.html'" class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600 transition-colors">
                            ë™ë¬¼ ì»¬ë ‰ì…˜ ë³´ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê·¸ ì™¸ ë©”ë‰´ -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6 opacity-0" style="animation: slideUp 1s ease-out 1.2s forwards;">
            <h3 class="font-bold text-gray-800 mb-4 flex items-center space-x-2">
                <span>âš™ï¸</span>
                <span>ê·¸ ì™¸ ë©”ë‰´</span>
            </h3>

            <div class="grid grid-cols-2 gap-3">
                <button onclick="window.location.href='progress-dashboard.html'" class="border-2 border-gray-200 text-gray-700 p-3 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors text-left">
                    <div class="text-2xl mb-1">ğŸ“Š</div>
                    <div class="text-sm font-semibold">í•™ìŠµ í˜„í™©</div>
                </button>

                <button onclick="window.location.href='social-hub.html'" class="border-2 border-gray-200 text-gray-700 p-3 rounded-lg hover:border-green-500 hover:bg-green-50 transition-colors text-left">
                    <div class="text-2xl mb-1">ğŸ’¬</div>
                    <div class="text-sm font-semibold">ì†Œí†µí•˜ê¸°</div>
                </button>

                <button onclick="window.location.href='data-manager.html'" class="border-2 border-gray-200 text-gray-700 p-3 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors text-left">
                    <div class="text-2xl mb-1">ğŸ’¾</div>
                    <div class="text-sm font-semibold">ë°ì´í„° ê´€ë¦¬</div>
                </button>

                <button onclick="window.location.href='analytics-console.html'" class="border-2 border-gray-200 text-gray-700 p-3 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors text-left">
                    <div class="text-2xl mb-1">ğŸ“ˆ</div>
                    <div class="text-sm font-semibold">í•™ìŠµ ë¶„ì„</div>
                </button>

                <button onclick="restartTutorial()" class="border-2 border-gray-200 text-gray-700 p-3 rounded-lg hover:border-cyan-500 hover:bg-cyan-50 transition-colors text-left">
                    <div class="text-2xl mb-1">ğŸ“–</div>
                    <div class="text-sm font-semibold">íŠœí† ë¦¬ì–¼ ë‹¤ì‹œë³´ê¸°</div>
                </button>
            </div>

            <div class="mt-3 text-center space-y-2">
                <button class="text-sm text-gray-400 hover:text-gray-600 cursor-not-allowed" disabled>
                    ğŸ’° ë³´ìƒ ìš”ì²­ (í–¥í›„ êµ¬í˜„)
                </button>
                <div class="flex flex-col space-y-1">
                    <button onclick="window.location.href='debug-console.html'" class="text-xs text-blue-500 hover:text-blue-700">
                        ğŸ› ë””ë²„ê·¸ ì½˜ì†”
                    </button>
                    <button onclick="window.location.href='clear-offline-queue.html'" class="text-xs text-red-500 hover:text-red-700">
                        ğŸ”§ ì˜¤í”„ë¼ì¸ í ì´ˆê¸°í™”
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¬¼ì£¼ê¸° í•™ìŠµ ëª¨ë‹¬ -->
    <div id="home-watering-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl p-6 max-w-lg w-full">
            <div class="text-center mb-4">
                <div class="text-4xl mb-2">ğŸŒ±</div>
                <h3 class="text-lg font-bold">ë¬¼ì£¼ê¸° í•™ìŠµ</h3>
            </div>

            <div class="bg-blue-50 rounded-lg p-4 mb-4">
                <div class="flex items-center mb-2">
                    <span class="text-2xl mr-2" id="home-question-subject-icon">ğŸ“š</span>
                    <div class="font-bold text-blue-900" id="home-question-title">ì•½ì  ê³¼ëª© í•™ìŠµ</div>
                </div>
                <div class="text-sm text-blue-800 mb-3" id="home-question-text">
                    ë¬¸ì œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
                </div>

                <div class="mb-3 p-3 bg-green-50 border-2 border-green-300 rounded-lg">
                    <div class="flex items-start space-x-2 mb-2">
                        <span class="text-lg">âœ…</span>
                        <div>
                            <div class="font-bold text-green-900 mb-1">ì •ë‹µ</div>
                            <div class="text-sm text-green-800" id="home-correct-answer"></div>
                        </div>
                    </div>
                    <div class="flex items-start space-x-2 mt-2 pt-2 border-t border-green-200">
                        <span class="text-lg">ğŸ’¡</span>
                        <div>
                            <div class="font-bold text-blue-900 mb-1">í•´ì„¤</div>
                            <div class="text-sm text-gray-700" id="home-explanation-text"></div>
                        </div>
                    </div>
                </div>

                <button id="home-water-confirm-btn" onclick="homeConfirmWater()" disabled
                        class="w-full px-4 py-3 bg-gray-400 text-white rounded-lg font-bold cursor-not-allowed transition-all">
                    <span id="home-water-btn-text">ğŸ’§ ë¬¸ì œë¥¼ ì½ì–´ì£¼ì„¸ìš” (<span id="home-countdown">3</span>ì´ˆ)</span>
                </button>
            </div>

            <div class="text-center">
                <button onclick="homeCloseWateringModal()" class="text-gray-500 text-sm hover:text-gray-700">
                    ë‚˜ì¤‘ì— í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <!-- ì‹ë¬¼ ì§„í™” ì¶•í•˜ ëª¨ë‹¬ -->
    <div id="home-celebration-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-yellow-50 to-green-50 rounded-2xl p-8 max-w-md w-full celebration-modal relative overflow-hidden">
            <!-- ë°°ê²½ ì¥ì‹ -->
            <div id="home-confetti-container" class="absolute inset-0 pointer-events-none"></div>

            <div class="relative z-10">
                <!-- ì¶•í•˜ ì•„ì´ì½˜ -->
                <div class="text-center mb-4">
                    <div class="text-8xl mb-4 glow-pulse" id="home-celebration-emoji">ğŸ‰</div>
                    <div class="text-2xl font-bold text-gray-800 mb-2" id="home-celebration-title">ì¶•í•˜í•©ë‹ˆë‹¤!</div>
                    <div class="text-lg text-gray-600 mb-4" id="home-celebration-message">ì‹ë¬¼ì´ ì„±ì¥í–ˆìŠµë‹ˆë‹¤!</div>
                </div>

                <!-- ë³€í™” í‘œì‹œ -->
                <div class="bg-white rounded-xl p-4 mb-6 shadow-lg">
                    <div class="flex items-center justify-center space-x-4">
                        <div class="text-center">
                            <div class="text-4xl mb-2" id="home-celebration-before">ğŸŒ°</div>
                            <div class="text-xs text-gray-500">ì´ì „</div>
                        </div>
                        <div class="text-3xl text-green-500">â†’</div>
                        <div class="text-center">
                            <div class="text-5xl mb-2 glow-pulse" id="home-celebration-after">ğŸŒ±</div>
                            <div class="text-xs text-gray-500">í˜„ì¬</div>
                        </div>
                    </div>
                </div>

                <!-- ì§„í–‰ë¥  í‘œì‹œ -->
                <div class="bg-gradient-to-r from-green-100 to-blue-100 rounded-lg p-3 mb-4">
                    <div class="text-center">
                        <div class="text-sm font-semibold text-gray-700 mb-2" id="home-celebration-progress">ì§„í–‰ë¥ </div>
                        <div class="flex justify-center items-center space-x-2">
                            <div class="flex space-x-1" id="home-celebration-stages">
                                <!-- ë™ì  ìƒì„± -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë‹¤ìŒ ëª©í‘œ -->
                <div class="bg-blue-50 rounded-lg p-3 mb-4 border-2 border-blue-200">
                    <div class="text-center text-sm">
                        <div class="font-semibold text-blue-800 mb-1">ë‹¤ìŒ ëª©í‘œ</div>
                        <div class="text-blue-700" id="home-celebration-next-goal">ê³„ì† ë¬¼ì£¼ê¸°!</div>
                    </div>
                </div>

                <!-- ë‹«ê¸° ë²„íŠ¼ -->
                <button onclick="homeCloseCelebrationModal()" class="w-full px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-bold hover:from-green-600 hover:to-blue-600 transition-all shadow-lg">
                    í™•ì¸
                </button>
            </div>
        </div>
    </div>

    <!-- ìˆ˜í™• ë³´ìƒ íŒì—… -->
    <div id="home-harvest-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center transform transition-all scale-95" id="home-harvest-content">
            <div class="text-7xl mb-4 animate-bounce">ğŸ‰</div>
            <h2 class="text-3xl font-bold text-gray-900 mb-3">ìˆ˜í™• ì™„ë£Œ!</h2>

            <div class="bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-xl p-6 mb-4">
                <div class="text-6xl mb-3">ğŸ’°</div>
                <div class="text-4xl font-bold text-orange-600" id="home-harvest-money">+100 ì½”ì¸</div>
            </div>

            <div class="text-gray-600 mb-6" id="home-harvest-message">
                ì‹ë¬¼ì„ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í™•í–ˆìŠµë‹ˆë‹¤!
            </div>

            <button onclick="closeHarvestModal()" class="w-full px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg font-bold hover:from-green-600 hover:to-green-700 transition-all shadow-lg">
                í™•ì¸
            </button>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ì•Œë¦¼ -->
    <div id="home-toast" class="hidden fixed bottom-4 right-4 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50">
        <div id="home-toast-message"></div>
    </div>

    <!-- í•™ë…„ ë³€ê²½ ëª¨ë‹¬ -->
    <div id="grade-change-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-8 max-w-lg w-full">
            <div class="text-center mb-6">
                <div class="text-6xl mb-4">ğŸ“</div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">í•™ë…„ ë³€ê²½</h2>
                <p class="text-sm text-gray-600">í•™ë…„ì— ë§ëŠ” ë‚œì´ë„ë¡œ ë¬¸ì œê°€ ì œê³µë©ë‹ˆë‹¤</p>
            </div>

            <div class="grid grid-cols-3 gap-3 mb-6">
                <button onclick="confirmGradeChange(1)" id="modal-grade-1" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸŒ°</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">1í•™ë…„</div>
                    <div class="text-xs text-gray-600">ê¸°ì´ˆ</div>
                </button>

                <button onclick="confirmGradeChange(2)" id="modal-grade-2" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸŒ±</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">2í•™ë…„</div>
                    <div class="text-xs text-gray-600">ì‰¬ì›€</div>
                </button>

                <button onclick="confirmGradeChange(3)" id="modal-grade-3" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸª´</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">3í•™ë…„</div>
                    <div class="text-xs text-gray-600">ë³´í†µ</div>
                </button>

                <button onclick="confirmGradeChange(4)" id="modal-grade-4" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸŒ³</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">4í•™ë…„</div>
                    <div class="text-xs text-gray-600">í‘œì¤€</div>
                </button>

                <button onclick="confirmGradeChange(5)" id="modal-grade-5" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸŒ²</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">5í•™ë…„</div>
                    <div class="text-xs text-gray-600">ì–´ë ¤ì›€</div>
                </button>

                <button onclick="confirmGradeChange(6)" id="modal-grade-6" class="grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105">
                    <div class="text-4xl mb-2">ğŸŒº</div>
                    <div class="text-lg font-bold text-gray-800 mb-1">6í•™ë…„</div>
                    <div class="text-xs text-gray-600">ê³ ê¸‰</div>
                </button>
            </div>

            <button onclick="closeGradeModal()" class="w-full px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-bold hover:bg-gray-300 transition-colors">
                ì·¨ì†Œ
            </button>
        </div>
    </div>

    <!-- í•„ìˆ˜ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="firebase-config.js"></script>
    <script src="firebase-auth.js"></script>
    <script src="firebase-integration.js"></script>
    <script src="plant-system.js"></script>
    <script src="daily-reset.js"></script>
    <script src="weakness-learning.js"></script>
    <script src="index-main.js"></script>
    <script src="index-missions.js"></script>
    <script src="index-farm.js"></script>

    <!-- í•™ë…„ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í•™ë…„ í‘œì‹œ ì—…ë°ì´íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            updateGradeDisplay();
        });

        // í•™ë…„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateGradeDisplay() {
            const userGrade = localStorage.getItem('userGrade') || '4';
            const gradeDisplay = document.getElementById('gradeDisplay');
            if (gradeDisplay) {
                gradeDisplay.textContent = `ğŸ“ ${userGrade}í•™ë…„`;
            }
        }

        // í•™ë…„ ë³€ê²½ ëª¨ë‹¬ ì—´ê¸°
        function changeGrade() {
            const currentGrade = localStorage.getItem('userGrade') || '4';
            const modal = document.getElementById('grade-change-modal');

            // ëª¨ë“  í•™ë…„ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            for (let i = 1; i <= 6; i++) {
                const btn = document.getElementById(`modal-grade-${i}`);
                if (btn) {
                    btn.className = 'grade-modal-btn p-4 border-4 border-gray-300 rounded-xl hover:border-blue-500 transition-all transform hover:scale-105';
                }
            }

            // í˜„ì¬ í•™ë…„ ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸
            const currentBtn = document.getElementById(`modal-grade-${currentGrade}`);
            if (currentBtn) {
                currentBtn.className = 'grade-modal-btn p-4 border-4 border-blue-500 bg-blue-50 rounded-xl transition-all transform scale-105';
            }

            modal.classList.remove('hidden');
        }

        // í•™ë…„ ë³€ê²½ í™•ì¸
        function confirmGradeChange(grade) {
            const currentGrade = localStorage.getItem('userGrade') || '4';

            if (grade.toString() === currentGrade) {
                closeGradeModal();
                return;
            }

            if (confirm(`í•™ë…„ì„ ${grade}í•™ë…„ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\në³€ê²½í•˜ë©´ ${grade}í•™ë…„ ìˆ˜ì¤€ì˜ ë¬¸ì œê°€ ì œê³µë©ë‹ˆë‹¤.`)) {
                localStorage.setItem('userGrade', grade.toString());
                updateGradeDisplay();
                closeGradeModal();

                // ì„±ê³µ í† ìŠ¤íŠ¸ í‘œì‹œ
                showToast(`âœ… í•™ë…„ì´ ${grade}í•™ë…„ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!`);

                console.log(`âœ… í•™ë…„ ë³€ê²½: ${grade}í•™ë…„`);
            }
        }

        // í•™ë…„ ë³€ê²½ ëª¨ë‹¬ ë‹«ê¸°
        function closeGradeModal() {
            document.getElementById('grade-change-modal').classList.add('hidden');
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ (ê°„ë‹¨ ë²„ì „)
        function showToast(message) {
            const toast = document.getElementById('home-toast');
            const toastMessage = document.getElementById('home-toast-message');

            if (toast && toastMessage) {
                toastMessage.textContent = message;
                toast.classList.remove('hidden');

                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }
        }
    </script>
</body>
</html>
